# 리그 오브 레전드: 골드 격차 기반의 라인별 기여도 분석 모델 제작 및 경기 해석 인사이트 도출

## 1. 문제 정의 (Problem Definition)

리그 오브 레전드(LoL)에서 경기의 승패는 단순히 최종 킬 스코어가 아닌, 각 라인에서 발생하는 미세한 '차이'가 누적되어 만들어진다. 또한 특정 라인이 언제, 어떻게 스노우볼을 굴리기 시작하는지, 그리고 그 격차가 승리에 얼마나 결정적인 영향을 미치는지를 파악하는 것은 게임을 깊이 이해하는 데 핵심적이다.

이 프로젝트는 경기 시간대별(**1분, 2분, 3분... 30분**) 데이터를 분석하여, 각 라인의 **경기 기여도를 '골드 격차'(`y`)로 정의**하고, 어떤 게임 내 지표(`X`)들이 이 기여도를 만들어내는지를 예측하는 **모델을 제작**하고, 이를 바탕으로 **라인별 기여도의 흐름**을 파악하고, 나아가 **소환사별 세부 지표**와 비교 분석하여 **경기의 승패 요인을 다각적으로 해석**하는 것을 목표로 한다.

## 2. 해결 방안 (Proposed Solution)

먼저 경기 데이터(`match_info`)와 타임라인 데이터(`timeline_info`)를 활용하여 `GoldDiffAnalyzer` 클래스를 구현했다. 이 클래스는 경기 시간대별 스냅샷 데이터를 바탕으로 각 라인의 상태를 나타내는 다양한 피처(`X`)를 추출한다.

추출된 피처들은 **`XGBoost Regressor` 모델의 입력값**으로 사용되어, 해당 시점의 **상대 라이너와의 골드 격차, 즉 라인별 기여도(`y`)를 예측**한다. 최종적으로, 이 모델을 통해 경기 전체의 기여도 흐름을 시각화하고, **어떤 라인의 기여도(골드 격차)가 승패를 결정짓는 핵심 요인이었는지 분석**한다.

## 3. 프로젝트 목표 (Goals)

- **첫째,** 각 **라인별 기여도(골드 격차)를 결정**하는 핵심 게임 지표(`X`)를 설계하고 엔지니어링한다.
- **둘째,** 라인별로 최적화된 `XGBoost Regressor` 모델을 `GridSearchCV`를 통해 튜닝하여, **시간대별 기여도(골드 격차)를 정확하게 예측**하는 모델을 구축한다.
- **셋째,** 제작된 모델을 활용하여 라인별 기여도 흐름을 분석하고, 소환사별 세부 지표와 연계하여 **경기의 승패 요인을 다각적으로 해석**하며 인사이트를 도출한다.

## 4. 실행 환경 구성

| 순서 | 단계 설명 | 내용 |
|:---|:---|:---|
| 1 | **라이브러리** | `pandas`, `numpy`, `scikit-learn`, `xgboost`, `tqdm` 등 스크립트 상단에 명시된 라이브러리 설치 |
| 2 | **데이터 준비** | 스크립트와 동일한 디렉토리 내 `match_data` 폴더에 `match_*.json`과 `timeline_*.json` 파일 준비 |
| 3 | **스크립트 실행** | `python dynamic_lol_line_win_v5_all_parameter.py` 명령어 실행 |

## 5. 데이터셋 설명

- **데이터셋 출처:** 리그 오브 레전드 API를 통해 수집된 경기 데이터
- **데이터 구성:**
  - `match_data` 폴더 내에 `match_*.json`과 `timeline_*.json` 파일이 **1,087쌍** 으로 구성되어 있다.
  - 각 파일 쌍은 하나의 게임을 의미하며, 분석에 사용된 총 경기 데이터는 **30,875개** 이다.
- **주요 데이터 파일:**
  - `match_n.json`: 경기의 참여자, 팀 정보, 최종 결과 등 요약 정보를 포함하고 있다.
  - `timeline_n.json`: 시간 흐름에 따른 모든 이벤트(킬, 미니언 처치 등)와 프레임별 스탯 정보를 포함한다.
- **데이터 처리 방식:**
  - `dynamic_lol_line_win_v5_all_parameter.py` 스크립트는 `match_*.json` 파일과 `timeline_*.json` 파일을 항상 **쌍(pair)** 으로 함께 처리한다. 즉, 경기 요약 정보(`match`)와 시간대별 상세 데이터(`timeline`)가 하나의 묶음(bundle)으로 결합되어야 비로소 `v5` 모델이 분석할 수 있는 완전한 경기 데이터가 완성된다.

## 6. 피처 엔지니어링 및 모델링

### 6.1. 데이터 처리 방식

본 모델은 **시간대별 스냅샷(Snapshot)** 데이터를 기반으로 피처를 생성한다.

- **스냅샷 데이터:** **1분, 2분, 3분 등** 특정 시점의 게임 상태를 사진처럼 포착한다. `_get_stats_at_minute(minute)` 함수를 사용하여 해당 시간대의 각 플레이어별 스탯(골드, CS, 레벨, KDA 등)을 추출하는 역할을 한다.
- **타겟 변수(y):** 블루팀 라이너와 레드팀 라이너 간의 **골드 격차로, 이는 곧 해당 라인의 '기여도'를 의미**한다.
- **독립 변수(X):** 각 라인의 '기여도(골드 격차)'를 예측하기 위한 핵심 게임 지표(CS, 레벨, KDA, 가한 피해량, 시야 점수 등)들의 차이를 피처로 사용한다.

### 6.2. 라인별 피처 설계

본 모델은 **1분부터 30분까지의 각 1분 단위 시간대별로** 데이터를 추출하여 총 10개의 피처를 생성한다. 또한 각 피처는 블루팀과 레드팀 라이너 간의 스탯 격차를 나타낸다.

- **특정 시점 (Snapshot):** `_get_stats_at_minute` 함수를 통해 추출되며, 각 시간대(**1분, 2분, ... 30분**)의 단일 데이터 프레임을 의미한다. 예를 들어 '15분'의 스냅샷 데이터는 15분 시점의 스탯만을 사용한다.

- **0분 ~ 특정 시점 (누적):** `_get_kda_up_to_minute` 함수처럼 경기 시작(0분)부터 각 시간대(**1분, 2분, ... 30분**)까지 발생한 모든 이벤트를 집계한다. 예를 들어 '15분'의 누적 데이터는 0분부터 15분까지 발생한 모든 킬, 데스, 어시스트를 합산하여 계산한다.

 #### 6.2.1. 탑 (TOP), 정글 (JUNGLE), 미드 (MIDDLE)
 
 탑, 정글, 미드는 각기 다른 플레이 스타일을 가지고 있지만, 모델링 관점에서는 **'개인의 역량'이 상대 라이너와의 1v1 구도에서 직접적으로 드러난다**는 공통점을 가진다. 바텀 라인의 2v2 상호작용과 달리, 이 세 라인의 기여도는 **상대와의 직접적인 스탯 격차**를 통해 효과적으로 측정할 수 있다고 생각했다.
 
 따라서 역할(Role)은 다르지만, 경기력을 구성하는 핵심 요소인 **①성장, ②교전, ③운영**이라는 세 가지 축을 동일하게 평가할 수 있다. 예를 들어, 탑과 미드의 'CS'와 정글의 '정글 몬스터'는 수급원은 달라도 '성장'이라는 동일한 척도로 해석될 수 있다. 이러한 공통 분모를 기반으로 표준화된 피처 셋을 사용하여 세 라인의 기여도를 일관된 기준으로 분석하기로 했다.
 
 | 피처 (Feature) | 데이터 소스 | 계산 방식 (블루팀 - 레드팀) | 데이터 시간 범위 | 선택 이유                                                                                          |
 |:---|:---|:---|:---|:-----------------------------------------------------------------------------------------------|
 | **CS 격차** | `timeline.frames` | `minionsKilled`의 차이 | 특정 시점 (매분) | **성장의 핵심**: 라인전 단계에서 골드 수급의 가장 기본이 되는 지표로, CS 우위는 곧 아이템 우위로 직결된다.                              |
 | **정글 몬스터 격차** | `timeline.frames` | `jungleMinionsKilled`의 차이 | 특정 시점 (매분) | **정글러 성장 척도**: 정글러의 핵심 성장 지표로, 정글 캠프 컨트롤과 성장 속도를 나타내며 이는 갱킹 및 오브젝트 컨트롤 능력에 영향을 준다.             |
 | **레벨 격차** | `timeline.frames` | `level`의 차이 | 특정 시점 (매분) | **경험치 우위**: 경험치 우위를 나타내는 지표로, 레벨이 높을수록 기본 능력치와 스킬 레벨이 높아져 전투에서 유리하다.                           |
 | **킬/데스/어시스트 격차** | `timeline.events` | `CHAMPION_KILL` 이벤트 집계 | 0분 ~ 특정 시점 (매분까지 누적) | **교전 능력**: 직접적인 교전 능력을 평가하는 핵심 지표다. 킬과 어시스트는 골드 획득을, 데스는 상대에게 골드를 헌납함을 의미하여 스노우볼에 직접적인 영향을 준다. |
 | **가한 피해량 격차** | `timeline.frames` | `damageStats.totalDamageDoneToChampions`의 차이 | 특정 시점 (매분) | **공격 기여도**: 상대 챔피언에게 얼마나 많은 피해를 입혔는지를 나타내며, 교전에서 공격적인 역할을 수행하는 정도를 측정한다.                       |
 | **받은 피해량 격차** | `timeline.frames` | `damageStats.totalDamageTaken`의 차이 | 특정 시점 (매분) | **탱킹 및 생존력**: 얼마나 많은 피해를 감수했는지를 나타낸다. 탱커에게는 팀 기여도를, 딜러에게는 포지셔닝 실패나 생존 능력을 평가하는 지표가 될 수 있다.     |
 | **시야 점수 격차** | `timeline.frames` | `visionScore`의 차이 | 특정 시점 (매분) | **맵 컨트롤**: 시야 장악은 갱킹 방지, 오브젝트 컨트롤, 잘라먹기 등 운영의 핵심이다. 이 지표는 게임의 정보전에서 얼마나 우위를 점하는지 보여준다.         |
 | **CC기 시간 격차** | `timeline.frames` | `timeCCingOthers`의 차이 | 특정 시점 (매분) | **변수 창출 능력**: 군중 제어(CC)는 교전의 향방을 결정하는 핵심 변수이다. 이 지표는 상대방을 얼마나 효과적으로 무력화시키고 교전 기회를 만드는지 측정한다.   |
 
 #### 6.2.2. 바텀 (BOTTOM)
 
 원딜(DUO_CARRY)과 서포터(DUO_SUPPORT)의 시너지가 중요한 바텀 라인은 두 플레이어의 스탯을 합산한 **통합 피처** 를 사용한다. 2v2 구도의 상호작용을 반영하기 위해 듀오의 합산 스탯과 함께, 팀의 핵심 후반 캐리인 원딜의 개별 성장 지표도 함께 고려한다.
 
 | 피처 (Feature) | 데이터 소스 | 계산 방식 (블루팀 듀오 - 레드팀 듀오) | 데이터 시간 범위 | 선택 이유                                                                                           |
 |:---|:---|:---|:---|:------------------------------------------------------------------------------------------------|
 | **듀오 총 CS 격차** | `timeline.frames` | `(ADC + 서포터) minionsKilled`의 합산 차이 | 특정 시점 (매분) | **라인 전체의 성장**: 원딜의 CS와 서포터 아이템으로 획득하는 미니언 골드를 종합적으로 반영하여, 바텀 라인 전체의 성장 수준을 측정한다.                |
 | **듀오 총 킬/데스/어시 격차** | `timeline.events` | `(ADC + 서포터) KDA`의 합산 차이 | 0분 ~ 특정 시점 (매분까지 누적) | **2v2 교전 능력**: 원딜과 서포터의 시너지를 통해 만들어내는 교전 결과를 종합적으로 평가한다.                                        |
 | **듀오 총 레벨 격차** | `timeline.frames` | `(ADC + 서포터) level`의 합산 차이 | 특정 시점 (매분) | **경험치 시너지**: 2인 라인의 경험치 총량을 비교하여, 특히 6레벨 궁극기 타이밍 등 중요한 성장 변곡점을 파악한다.                            |
 | **듀오 총 가한 피해량**| `timeline.frames` | `(ADC + 서포터) totalDamageDoneToChampions`의 합산 차이 | 특정 시점 (매분) | **듀오의 공격성**: 원딜의 지속적인 피해와 서포터의 견제가 합쳐진 총 피해량을 통해 라인전 압박 능력을 측정한다.                               |
 | **듀오 총 받은 피해량**| `timeline.frames` | `(ADC + 서포터) totalDamageTaken`의 합산 차이 | 특정 시점 (매분) | **듀오의 안정성**: 두 플레이어가 받은 피해량을 합산하여, 라인전에서 얼마나 안정적으로 포지셔닝하고 생존하는지를 평가한다.                          |
 | **듀오 총 시야 점수** | `timeline.frames` | `(ADC + 서포터) visionScore`의 합산 차이 | 특정 시점 (매분) | **바텀 시야 장악력**: 갱킹에 가장 취약한 라인 중 하나인 바텀의 시야 장악 수준을 평가하며, 이는 생존과 직결된다.                             |
 | **듀오 총 CC기 시간** | `timeline.frames` | `(ADC + 서포터) timeCCingOthers`의 합산 차이 | 특정 시점 (매분) | **교전 주도권**: 주로 서포터가 제공하는 CC기와 원딜의 CC기를 합산하여, 교전을 열고 변수를 만드는 능력을 종합적으로 측정한다.                     |
 | **원딜 CS 격차** | `timeline.frames` | `ADC minionsKilled`의 차이 (단독 비교) | 특정 시점 (매분) | **핵심 캐리의 성장**: 팀의 후반 보험인 원거리 딜러의 개인 성장세를 직접적으로 추적하기 위한 핵심 지표이다. 듀오의 성과와 별개로 원딜의 순수 파밍 능력을 평가한다. |

## 7. 모델 학습 및 평가

### 7.1. 모델 선택 이유: XGBoost Regressor

본 프로젝트에서 **기여도(골드 격차) 예측 모델**로 `XGBoost Regressor`를 선택한 주요 근거는 다음과 같다.

-   **높은 예측 성능**: XGBoost는 Gradient Boosting Decision Tree(GBDT)의 최적화된 구현체로, 뛰어난 예측 정확도를 자랑한다. 복잡한 비선형 관계를 학습하는 데 매우 효과적이며, 다양한 캐글(Kaggle) 경연 대회에서 우승을 차지하며 그 성능을 입증했다. LoL 데이터와 같이 복잡하고 상호작용이 많은 데이터셋에 적합하다고 생각했다.
-   **과적합 방지 및 일반화 능력**: L1/L2 정규화, 서브샘플링, 컬럼 샘플링 등 다양한 정규화 기법을 내장하고 있어 과적합을 효과적으로 방지하고, 새로운 데이터에 대한 일반화 성능이 우수하다. 이는 실제 게임 데이터의 다양성을 고려할 때 중요한 장점이라고 생각했다.
-   **피처 중요도 제공**: XGBoost는 모델 학습 후 각 피처의 중요도를 제공하여, 어떤 게임 지표가 골드 격차 예측에 가장 큰 영향을 미치는지 해석하고 인사이트를 도출하는 데 도움을 준다.
-   **확장성 및 효율성**: 병렬 처리 및 분산 처리를 지원하여 대규모 데이터셋에서도 효율적인 학습이 가능하다. 또한, GPU 가속을 지원하여 학습 시간을 단축할 수 있다.
-   **결정 트리 기반의 장점**: 의사결정 트리 앙상블 모델로서, 데이터의 스케일에 덜 민감하며, 이상치(Outlier)에 비교적 강건한 특성을 가진다.

이러한 장점들을 바탕으로 XGBoost Regressor는 LoL 라인별 기여도(골드 격차) 예측이라는 문제에 가장 적합한 모델이라고 판단했다.

### 7.2. 모델 학습 및 평가

- **모델:** `XGBoost Regressor`
- **최적화:** `GridSearchCV`를 사용하여 각 라인별 모델의 하이퍼파라미터를 튜닝한다.
- **평가 지표:**
  - **R² (결정 계수):** 모델이 **기여도(골드 격차)** 를 얼마나 잘 설명하는지를 나타내는 지표 (1에 가까울수록 좋다).
  - **RMSE (평균 제곱근 오차):** 예측값과 실제값의 차이를 나타내는 지표 (0에 가까울수록 좋다).

스크립트 실행 시, 각 라인별 모델의 테스트 데이터셋에 대한 최종 성능이 아래와 같은 형식으로 출력된다.

```
--- [ 모델 최종 성능 요약 (Test Set) ] ---

모델       | R² (설명력) | RMSE (정규화된 값)
----------------------------------------
TOP      | 0.XXX      | 0.XXXX
JUNGLE   | 0.XXX      | 0.XXXX
MIDDLE   | 0.XXX      | 0.XXXX
BOTTOM   | 0.XXX      | 0.XXXX
```

#### 성능 평가

제공된 모델 성능 요약에 따르면, 모든 라인에서 `XGBoost Regressor` 모델이 매우 우수한 예측 성능을 보였다.

--- [ 모델 최종 성능 요약 (Test Set) ] ---

| 모델     | R² (설명력) | RMSE (정규화된 값) |
|:---------|:------------|:-------------------|
| TOP      | 0.893       | 0.0380             |
| JUNGLE   | 0.921       | 0.0303             |
| MIDDLE   | 0.883       | 0.0353             |
| BOTTOM   | 0.897       | 0.0492             |

==================================================

-   **높은 R² 점수**: 모든 라인에서 R² 점수가 0.88 이상으로 나타났다. 이는 모델이 **기여도(골드 격차)** 변동성의 88% 이상을 설명할 수 있음을 의미하며, 실제 기여도의 변화를 모델이 매우 잘 포착하고 있음을 시사한다. 특히 JUNGLE 라인은 0.921로 가장 높은 설명력을 보여, 정글러의 활동이 기여도에 미치는 영향이 비교적 명확하게 모델링되었음을 알 수 있다.
-   **낮은 정규화된 RMSE**: RMSE 값은 예측 오차의 크기를 나타내는데, 모든 라인에서 0.05 미만의 낮은 정규화된 RMSE 값을 기록했다. 이는 모델의 예측값이 실제값과 매우 가깝다는 것을 의미하며, 정규화된 스케일에서 예측 오차가 작아 모델의 정밀도가 높음을 보여준다.
-   **라인별 성능 일관성**: 각 라인별로 성능 차이가 크지 않아, 피처 엔지니어링 및 모델링 접근 방식이 모든 라인에 걸쳐 견고하게 작동함을 알 수 있다. JUNGLE 라인이 가장 좋은 성능을 보였고, MIDDLE 라인이 상대적으로 약간 낮은 R²를 기록했지만 여전히 매우 높은 수준이다. BOTTOM 라인은 2v2 구도의 복잡성으로 인해 다른 라인에 비해 RMSE가 다소 높게 나타났지만, R²는 여전히 0.897로 높은 설명력을 유지하는것을 볼수 있다.

전반적으로 이 모델은 리그 오브 레전드 경기에서 라인별 기여도(골드 격차)를 매우 정확하게 예측할 수 있는 강력한 도구임을 입증했다.

## 8. 모델 예측 시각화 및 정확도 분석

`visualize.py` 스크립트는 학습된 모델이 특정 경기의 **기여도(골드 격차) 흐름**을 얼마나 잘 예측하는지 시각적으로 확인하는 도구이다.

### 8.1. 실행 방법

1. `dynamic_lol_line_win_v5_all_parameter.py`를 실행하여 모델(`*.joblib`)과 데이터(`preprocessed_gold_diff_data.json`)를 생성한다.
2. `python visualize.py` 명령어를 실행한다.

### 8.2. 동작 방식

- 스크립트는 `preprocessed_gold_diff_data.json` 파일에 있는 모든 경기 중 하나를 **무작위로 선택** 한다.
- 선택된 경기에 대해, 각 라인(TOP, JUNGLE, MIDDLE, BOTTOM)별로 시간대(**1분, 2분, ... 30분**)에 따른 **실제 골드 격차**와 **모델이 예측한 골드 격차**를 라인 그래프로 비교하여 보여준다.

### 8.3. 그래프 해석 방법

- **실선 (Actual):** 실제 해당 시점의 골드 격차(기여도)를 나타낸다.
- **점선 (Predicted):** 모델이 예측한 골드 격차(기여도)를 나타낸다.
- **두 선의 유사성:** 실선과 점선이 서로 가깝게 그려질수록 모델이 해당 경기의 기여도 흐름을 정확하게 예측했음을 의미한다.
- **그래프 분석:** 이 시각화 자료를 통해 다음과 같은 분석을 수행할 수 있다.
  - 모델이 특정 라인(예: 탑)의 예측을 더 잘하는가?
  - 게임 초반부와 후반부 중 어느 시점의 예측이 더 정확한가?
  - 실제 값과 예측 값이 큰 차이를 보이는 '예측 실패' 구간은 어떤 상황에서 발생하는가?

이 분석을 통해 모델의 강점과 약점을 직관적으로 파악하고, 향후 모델 개선 방향을 설정하는 데 중요한 근거로 활용할 수 있다.

## 9. 특정 경기 분석 및 승패 예측 결론

본 프로젝트에서 개발한 모델과 분석 도구를 활용하여, 특정 경기(`matchId: 7574234387`)의 승패를 예측하고 그 과정을 분석했다.

### 9.1. 1단계: 경기 데이터 시각화 및 초기 분석

먼저 **`visualize.py` 스크립트**를 통해 해당 경기의 라인별 **기여도(골드 격차) 추이**를 시각화 하였다. 그래프에서 **파란색 선은 블루팀의 상대 대비 기여도**, **빨간색 선은 레드팀의 상대 대비 기여도**를 의미한다. 각 팀의 선이 양수 값을 가질수록 해당 팀이 상대보다 우세함을 나타낸다.

![경기 시각화](pictures/match_visualize.png)
*<그림 1: Match 7574234387의 라인별 실제 및 예측 기여도(골드 격차)>*

-   **TOP, JUNGLE**: 두 라인 모두 경기 초반부터 **블루팀(파란선)** 이 레드팀(빨간선)보다 높은 기여도를 유지하며 근소한 우위를 점했다.
-   **BOTTOM**: **레드팀(빨간선)** 이 10분 시점부터 블루팀(파란선)을 압도하며 기여도 격차를 크게 벌렸다. 이 라인이 레드팀의 핵심적인 스노우볼 동력이었음을 알 수 있었다.
-   **MIDDLE**: **레드팀(빨간선)** 이 블루팀(파란선)보다 근소하게 앞서며 팽팽한 라인전을 이어갔다.

이 그래프를 통해 **블루팀은 상체(TOP, JUNGLE)에서, 레드팀은 하체(BOTTOM, MIDDLE)에서 우위를 점했다**는 초기 분석을 할 수 있었다. 하지만 어느 쪽의 우세가 승패에 더 결정적인 영향을 미쳤는지는 아직 판단하기 어렵다.

### 9.2. 2단계: 챌린저 평균 데이터와 비교 분석

단순 기여도의 유의미성을 판단하기 위해, `challenger_player_analyzer.py`를 통해 생성한 **챌린저 플레이어들의 평균 경기력 데이터**를 '기준점(Baseline)'으로 설정했다. 이 기준점은 각 라인별 상위 챌린저 5명의 승리 경기 데이터를 평균 낸 것으로, **이기는 플레이어의 평균적인 모습**을 의미한다.

**`visualize_with_challenger_average.py` 스크립트**를 사용하여 해당 경기의 팀별 경기력을 챌린저 평균과 비교했습니다. (1.0 초과: 챌린저 평균 이상, 1.0 미만: 챌린저 평균 이하)

![팀별 챌린저 평균 비교](pictures/match_detail.png)
*<그림 2: 팀별 경기력의 챌린저 평균 대비 추이>*

-   **초반 (5분 ~ 25분)**: **블루팀(파란선)** 이 챌린저 평균을 상회하는 경기력을 보이며 초반 주도권을 잡았다. 이는 <그림 1>에서 블루팀의 상체가 우세했던 상황과 일치한다. 하지만 레드팀 역시 챌린저 평균에 근접하며 끈질기게 따라가는 모습을 보였다.
-   **전환점 (25분)**: **25분을 기점으로 게임의 양상이 완전히 뒤바뀐다.** **레드팀(빨간선)** 의 경기력이 폭발적으로 급등하며 챌린저 평균을 크게 상회하기 시작했다. 동시에 블루팀의 경기력은 챌린저 평균 아래로 급격히 추락했다.
-   **후반 (25분 이후)**: 한번 흐름을 잡은 **레드팀**은 경기 후반까지 압도적인 경기력을 유지하며 승기를 굳혔다. 반면 블루팀은 무너진 흐름을 회복하지 못하고 패배에 이르게 되었다. 이 25분의 역전이 레드팀의 최종 승리를 이끈 결정적인 순간이었음을 알 수 있었다.

### 9.3. 3단계: 팀별 라인 상세 분석 및 최종 결론

<그림 2>에서 나타난 25분 기점의 극적인 역전이 어느 라인에서 비롯되었는지, `match_detail_blue.png`와 `match_detail_red.png`를 통해 심층적으로 분석한다.

| 블루팀 라인별 분석                                       | 레드팀 라인별 분석                                         |
| :------------------------------------------------------- | :--------------------------------------------------------- |
| ![블루팀 상세](pictures/match_detail_blue.png) | ![레드팀 상세](pictures/match_detail_red.png) |
| *<그림 3: 블루팀 라인별 챌린저 평균 대비 경기력>*         | *<그림 4: 레드팀 라인별 챌린저 평균 대비 경기력>*           |

-   **블루팀 분석 (<그림 3>)**:
    -   **초반 (1분~5분)**: 모든 라인이 챌린저 평균(1.0) 이하의 경기력으로 불안하게 출발했다.
    -   **중반 이후**: **TOP, JUNGLE** 라인은 챌린저 평균 수준의 경기력을 회복하며 분전하는 모습을 보였다. 하지만 **MIDDLE, BOTTOM** 라인은 경기 내내 챌린저 평균에 미치지 못하는 부진한 경기력을 보이며, 팀의 패배에 결정적인 원인을 제공했다.

-   **레드팀 분석 (<그림 4>)**:
    -   초반부터 압도적인 모습을 보였던 **BOTTOM** 라인은 경기 후반으로 갈수록 더욱 폭발적인 경기력을 보여주며 챌린저 평균을 크게 상회했다.
    -   **MIDDLE** 라인 또한 꾸준히 챌린저 평균 이상의 경기력을 유지하며 팀의 허리를 든든하게 받쳤다.
    -   **TOP, JUNGLE** 라인은 상대에게 밀리며 부진했지만, 하체의 압도적인 성장이 상체의 부진을 모두 만회했다.

### 최종 결론: 레드팀의 역전승

-   **승리 요인**: **레드팀의 압도적인 하체(BOTTOM, MIDDLE) 캐리**가 역전승의 핵심 동력이었다. 특히 **BOTTOM** 라인이 초반부터 벌려놓은 기여도를 바탕으로 25분 이후 게임을 완전히 지배했으며, **MIDDLE**이 안정적으로 뒷받침하며 승기를 굳혔다.
-   **패배 요인**: 블루팀은 상체(TOP, JUNGLE)가 초반 우위를 점했으나, 이를 게임 승리로 연결시키지 못했다. **25분 이후 BOTTOM 라인이 급격히 무너지고** 상대의 스노우볼을 막지 못한 것이 결정적인 패배 요인으로 작용했다.

**결론적으로, 이 경기는 초반의 불리함을 극복하고 후반에 집중력을 발휘한 레드팀의 승리이다.** 이 분석 과정은 단순히 초반 지표만 보는 것을 넘어, 게임의 '전환점'을 포착하고 각 라인이 승리에 얼마나 기여했는지를 다각적으로 평가하는 것이 중요함을 보여준다.

### 9.4. 심층 분석: `lol_analysis_unified_v3.py`를 통한 바텀 라인 플레이어 성향 분석

9.3의 경기 분석을 통해 레드팀 바텀 라인의 압도적인 캐리력이 승패의 핵심 요인이었음을 확인했다. 본 섹션에서는 `lol_analysis_unified_v3.py` 스크립트를 활용하여, 해당 경기에 참여한 바텀 라인 플레이어(원딜, 서포터)들의 과거 데이터를 심층 분석하였다. 특정 경기의 퍼포먼스가 일회성인지, 아니면 플레이어의 근본적인 실력과 성향에 기반한 것인지를 검증하려고 한다.

#### 9.4.1. 플레이어별 라인 선호도 분석

플레이어의 주 포지션 숙련도는 경기력에 직접적인 영향을 미친다. 아래는 각 플레이어의 모든 경기 데이터를 기반으로 한 라인별 플레이 횟수 분석이다.

|                              레드팀 (승리)                              |                               블루팀 (패배)                                |
|:------------------------------------------------------------------:|:---------------------------------------------------------------------:|
|                          **BOTTOM (원딜)**                           |                            **BOTTOM (원딜)**                            |
| ![레드팀 원딜 라인 선호도](pictures/analysis_red_BOTTOM_lane_preference.png) |  ![블루팀 원딜 라인 선호도](pictures/analysis_blue_BOTTOM_lane_preference.png)  |
|                         **UTILITY (서포터)**                          |                           **UTILITY (서포터)**                           |
|            ![레드팀 서포터 라인 선호도](pictures/analysis_red_UTILITY_lane_preference.png)             | ![블루팀 서포터 라인 선호도](pictures/analysis_blue_UTILITY_lane_preference.png) |

**분석:**
- **바텀(원딜) 포지션**: 양 팀의 원딜 모두 **바텀 라인을 압도적으로 많이 플레이**한 것을 확인할 수 있다. 이는 두 선수 모두 자신의 주력 포지션에서 경기에 임했음을 의미한다.
- **서포터 포지션**: 흥미로운 차이점이 발견되었다.
    - **블루팀 서포터**는 **서포터 포지션의 플레이 횟수가 압도적으로 높은 '서포터 장인'** 이다.
    - 반면, **레드팀 서포터**는 주 포지션이 바텀(원딜)임에도 불구하고 해당 경기에서는 **서포터 역할을 수행**했다. 이는 팀을 위해 다른 포지션을 소화한 것으로, 숙련도 측면에서는 블루팀 서포터가 더 유리할 수 있었음을 시사한다.

#### 9.4.2. 최근 10경기 기여도 분석

플레이어의 최근 경기력, 즉 '폼'은 경기 당일의 컨디션을 예측하는 중요한 지표이다. 기존의 복잡한 정규화 점수 대신, **'경기별 평균 누적 골드 격차'** 라는 직관적인 지표를 사용했다.

- **분석 기준**: 그래프의 y축은 경기 전체(1분~30분)의 '누적 골드 격차' 값들의 **산술 평균**을 의미한다.
- **0 골드 기준선(검은색 점선)**: 이 선은 상대 라이너와 골드 격차가 전혀 없는 **절대적인 기준점**이다. 점이 이 선보다 위에 있다면 해당 경기에서 평균적으로 상대를 리드했음을, 아래에 있다면 뒤처졌음을 의미한다.

|                              레드팀 (승리)                              |                               블루팀 (패배)                                |
|:------------------------------------------------------------------:|:---------------------------------------------------------------------:|
|                          **BOTTOM (원딜)**                           |                            **BOTTOM (원딜)**                            |
| ![레드팀 원딜 최근 10경기](pictures/analysis_red_BOTTOM_performance_v3.png) |  ![블루팀 원딜 최근 10경기](pictures/analysis_blue_BOTTOM_performance_v3.png)  |
|                         **UTILITY (서포터)**                          |                           **UTILITY (서포터)**                           |
|            ![레드팀 서포터 최근 10경기](pictures/analysis_red_UTILITY_performance_v3.png)            | ![블루팀 서포터 최근 10경기](pictures/analysis_blue_UTILITY_performance_v3.png) |

**분석:**
이 차트를 통해 플레이어의 최근 10경기 폼을 한눈에 볼 수 있었다. 또한 각 점(경기)의 위치를 통해 승리(W)와 패배(L) 여부, 그리고 해당 경기의 챔피언과 평균 골드 격차를 같이 확인할 수 있었다.

특히, 각 그래프의 제목에 있는 **'전체 표준편차'** 값은 플레이어의 최근 기복을 나타낸다. **레드팀 바텀 듀오(원딜: 1567, 서포터: 1565)의 표준편차가 블루팀 바텀 듀오(원딜: 1768, 서포터: 1740)보다 낮게 나타났다.** 이는 레드팀 바텀 듀오가 최근 더 기복 없이 **안정적인 경기력**을 보여주고 있었음을 시사한다.

#### 9.4.3. 플레이어 성향 분석 (중앙값 및 표준편차)

플레이어의 장기적인 데이터를 통해 '평균적인 실력(중앙값)'과 '기복(표준편차)'을 분석하여 근본적인 플레이 스타일을 파악한다.

- **분석 기준**:
    - **막대 높이(중앙값, Median)**: 플레이어의 평균적인 실력을 나타낸다. 높을수록 꾸준히 좋은 성과를 낸다.
    - **오차 막대(표준편차, Std)**: 플레이어의 기복을 나타낸다. 막대가 짧을수록 안정적이다.
    - **빨간색 점선(라인 전체 평균)**: 분석된 모든 경기의 모든 플레이어 데이터를 기반으로 계산된 **'해당 라인의 통계적 평균 성과'** 이다. 플레이어의 실력을 객관적으로 비교할 수 있는 기준점 역할을 한다.

| 레드팀 (승리) |                                블루팀 (패배)                                |
| :---: |:----------------------------------------------------------------------:|
| **BOTTOM (원딜)** |                            **BOTTOM (원딜)**                             |
| ![레드팀 원딜 성향 분석](pictures/analysis_red_BOTTOM_lane_stability_v3.png) |  ![블루팀 원딜 성향 분석](pictures/analysis_blue_BOTTOM_lane_stability_v3.png)  |
| **UTILITY (서포터)** |                           **UTILITY (서포터)**                            |
| ![레드팀 서포터 성향 분석](pictures/analysis_red_UTILITY_lane_stability_v3.png) | ![블루팀 서포터 성향 분석](pictures/analysis_blue_UTILITY_lane_stability_v3.png) |

**종합 분석:**
- **바텀(원딜) 비교**:
    - **레드팀 원딜**의 중앙값은 약 **+100 골드**인데 반해, **블루팀 원딜**은 약 **+19 골드**에 불과했다. 이는 레드팀 원딜이 평균적으로 라인전에서 더 꾸준히 우위를 점하는 플레이어임을 의미한다.
    - 두 원딜의 캐리력 포텐셜을 보여주는 최대 골드 격차(고점)는 +1500 이상으로 비슷했지만, 부진했을 때의 최소 골드 격차(저점)에서 차이가 드러났다. 레드팀 원딜의 저점은 -1500 골드 선에서 방어된 반면, 블루팀 원딜은 -1500 골드 이하로 크게 무너지는 모습을 보였다.
    - 이는 블루팀 원딜의 기복이 더 심하다는 것을 의미하며, 앞서 9.4.2에서 확인된 **더 높은 표준편차(레드: 1567 vs 블루: 1768)** 가 이러한 경향성을 뒷받침한다.

- **서포터 비교**:
    - 두 서포터 모두 라인 전체 평균(빨간 점선)에는 미치지 못하는 모습을 보이지만, 세부적으로 보면 레드팀 서포터가 더 나은 지표를 보였다.
    - **레드팀 서포터**의 중앙값은 **-230 골드**, 표준편차는 **1565**인 반면, **블루팀 서포터**의 중앙값은 **-473 골드**, 표준편차는 **1740**이다.
    - 고점과 저점을 비교해 보아도, 레드팀 서포터의 최대 골드 격차는 +1000 ~ +1500 사이로 블루팀보다 다소 높았으며, 최소 골드 격차 역시 -2000 골드 선에서 방어된 반면 블루팀 서포터는 -2000 골드 이하까지 떨어졌다.
    - 즉, 주 포지션이 아님에도 불구하고 **레드팀 서포터가 블루팀 서포터보다 평균적인 성과(중앙값)가 더 높고, 고점과 저점의 방어선도 더 안정적이었다.** 이는 역시 더 낮은 표준편차 값으로 증명되었다.

**최종 결론:**
`lol_analysis_unified_v3.py`를 통한 심층 분석 결과, 레드팀 바텀 듀오는 블루팀에 비해 **더 높은 평균 실력(중앙값)과 더 적은 기복(표준편차)** 을 가진, 즉 **더 우월하고 안정적인 플레이어**들임이 데이터로 증명되었다. 따라서 9.3에서 분석된 특정 경기의 압도적인 바텀 캐리는 우연이 아닌, 이들의 근본적인 실력 차이에서 비롯된 필연적인 결과였다고 결론 내릴 수 있다.

### 9.5. 한계점 및 개선 방향

본 프로젝트는 `dynamic_lol_line_win_v5_all_parameter.py` (XGBoost 모델 학습), `visualize.py` (기여도 예측 시각화), `visualize_with_challenger_average.py` (챌린저 평균 비교), `lol_analysis_unified_v3.py` (플레이어 성향 분석) 등 여러 스크립트를 통해 경기 데이터를 다각도로 해석했다. 이 접근은 성공적으로 경기의 승패 요인을 입증했지만, 다음과 같은 명확한 한계점을 가지며 이를 통해 향후 개선 방향을 도출할 수 있었다.

- **정적(Static) 피처의 한계**:
    - **팀 조합 미반영**: 챔피언 간의 시너지(예: 야스오-그라가스)나 카운터 관계, 팀 조합의 유불리(예: 초반 교전 조합 vs 후반 성장 조합) 등은 현재 모델에서 고려되지 않았다. 이는 경기 초반의 유불리 예측 정확도를 떨어뜨리는 요인이 될 수 있다.
    - **룬, 아이템 빌드 미반영**: 같은 챔피언이라도 룬 설정이나 아이템 빌드에 따라 성능이 크게 달라지지만, 이러한 변수들은 피처에 포함되지 않았다.

- **거시적(Macro) 운영 데이터의 부재**: 현재 분석은 주로 라인전 단계의 스탯에 집중되어 있다. 스플릿 푸시, 대규모 한타 설계, 오브젝트(용, 바론) 획득 타이밍 및 이를 둘러싼 운영 등 팀 단위의 거시적인 전략은 피처에 포함되지 않아, 특히 경기 중후반의 승패를 결정짓는 핵심적인 요인을 놓칠 수 있다.

#### 개선 방향

1. **분석 모델 고도화 (피처 확장)**:
    - **플레이어 성향 피처화**: `lol_analysis_unified_v3.py`에서 계산된 플레이어의 성향 데이터(중앙값, 표준편차 등)를 XGBoost 모델의 **새로운 피처로 추가**하여, '기복이 심한 플레이어'의 경기력을 예측하는 모델의 정확성을 높인다.
    - **팀 조합/메타 피처 엔지니어링**: 챔피언별 역할(탱커, 딜러 등), CC기 보유 개수, 사거리 등을 데이터화하여 '조합 점수'를 피처로 생성하고, 룬/아이템 빌드를 원-핫 인코딩 방식으로 피처에 추가한다.

2. **시계열(Time-series) 및 이벤트 기반 분석 도입**:
    - **거시 운영 이벤트 플래그(Flag) 추가**: '첫 타워 파괴', '첫 용 획득', '바론 버프 획득' 등 주요 게임 이벤트를 기준으로 데이터에 플래그를 지정하고, 해당 이벤트 전후의 골드 격차 변화를 분석하여 운영의 가치를 정량화한다.
    - **LSTM 등 시계열 모델 적용**: 시간의 흐름에 따른 데이터의 연속적인 패턴을 더 잘 학습할 수 있는 LSTM(Long Short-Term Memory)과 같은 딥러닝 모델을 도입하여, 경기 흐름의 '모멘텀' 변화를 예측하는 모델을 연구한다.
